The files in the folder print_charges are used to perform a QM coupling calculation via WaveT and prints the BEM_diagonal charges.

The model assumes a Drude-like dielectric constants with Ag parameters in the &EPS_FUNCTION namelist (for direct comparison with MNPBEM by Ulrich Hohenester). The plexcitonic matrix is built by assuming quantum coupling between molecule and diagonal plasmonic modes and a semiclassical dipolar coupling for the molecule-driving field interaction.

The BEM_diagonal charges are printed through the &PRINT_CHARGES namelist. This namelist requires medium_type="qna". 

N.B.
The namelist requires medium_type='qna' and bem_type='diag' to run

&PRINT_CHARGES               !activates the namelist keywords to print the BEM_diagonal charges associated to each plasmonic mode.
n_prnt_charges= 3.           !number of plasmonic modes of which we want to print the plasmonic charges. If -1.0 prints the charges associated to all the plasmonic modes. Default is 0.0 (the charges are not printed).
prnt_charges= 2. 3. 4.       !list of plasmonic modes to print the plasmonic charges of. Length of the prnt_charges must be equal to n_prnt_charges. Keyword ignored if n_prnt_charges=-1.0, as all the charges are printed
charge_mopac='yes'           !prints the charges in the database format to be read by mopac2002. default is 'non' (not printed)
\

Instructions to run the test.
1) Requires the cavity.inp and the mat_SD.inp files.
  -Note 1: These files can be obtained via the TDPlas nanoparticle internal builder, commented input and test at TDPlas/tests/NP_tdplas 
  -Note 2: alternatively, the nanoparticle can be built from a .msh file generated by GMSH and running TDPlas, commented input and tests and additional processing scripts at TDPlas/tests/gmsh_nanoparticles for spheres, ellipsoid and spheres with a non-uniform mesh.
2) Once the cavity.inp and the mat_SD.inp files are generated, move them in the working directory where the wavet.inp is (for the current test: ./print_charges).
3) Run tdplas.x by specifying input_surface='fil' as in this test
4) Each set of charges is printed as a frame of a .pqr file compatible with VMD, namely qnp_charges.pqr. 
6) A database-like file collecting the charges for each plasmon mode is generated as well in two formats qnp_charges.dat (always) and qnp_mop.mat (optional).
